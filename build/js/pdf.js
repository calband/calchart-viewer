(()=>{var t={707:(t,e,i)=>{var s=i(730),n=i(925),o=i(642),r=function(t,e){this.westUp="west"===e,o.apply(this,[t])};s.extends(r,o),r.prototype.draw=function(t,e,i,s,o){var r=this,a=n.getTextWidth("S",n.DEFAULT_FONT_SIZE),h=(n.getTextHeight(n.DEFAULT_FONT_SIZE),i-2*(a+1.5)),d={x:t,y:e,width:h,height:84*h/160};d.x+=i/2-d.width/2,d.y+=s/2-d.height/2,this._drawBox(d.x,d.y,d.width,d.height,this.westUp,o.minimal);var p=o.sheet.getDots(),l=o.dot,u=d.width/160;this.pdf.setLineWidth(.2),this.pdf.setDrawColor(150),this.pdf.vLine(d.x+d.width/2,d.y,d.height);for(var f=d.width/21,c=d.y+32*u,g=d.y+52*u,_=0;_<21;_+=2)t=d.x+_*f,this.pdf.hLine(t,c,f),this.pdf.hLine(t,g,f);this.pdf.setFillColor(210),p.forEach((function(t){if(t!==l){var e=t.getAnimationState(0);r.westUp||(e.x=160-e.x,e.y=84-e.y),r.pdf.circle(d.x+e.x*u,d.y+e.y*u,.5,"F")}}));var v=l.getAnimationState(0);this.westUp||(v.x=160-v.x,v.y=84-v.y),t=v.x*u,e=v.y*u,this.pdf.setFillColor(0),this.pdf.circle(d.x+t,d.y+e,.5,"F"),this.pdf.resetFormat()},t.exports=r},705:(t,e,i)=>{var s=i(730),n=i(925),o=i(642),r=function(t){o.apply(this,[t])};s.extends(r,o),r.prototype.draw=function(t,e,i,s,o){var r={x:t+2,y:e+1,size:10},a=o.dotType,h=i-4-6,d=s-2-3,p=o.sheet.getContinuityTexts(a);if(this.pdf.rect(t,e,i,s-1.5),void 0!==p){for(p=p.map((function(t){for(;n.getTextWidth(t,r.size)>h;)r.size--;return t}));p.length*n.getTextHeight(r.size)>d;)r.size--;this.pdf.drawDot(a,r.x+1.5,r.y+2,1.5),r.x+=4,this.pdf.setFontSize(10),this.pdf.text(":",r.x,r.y+n.getTextHeight(10)),this.pdf.setFontSize(r.size),r.x+=2,r.y+=n.getTextHeight(r.size),this.pdf.text(p,r.x,r.y),this.pdf.resetFormat()}},t.exports=r},519:(t,e,i)=>{var s=i(730),n=i(925),o=i(642),r=function(t,e){this.dotLabel="Dot "+e.dotLabel,this.title=e.title,this.totalSheets=e.totalSheets,this.totalPages=Math.ceil(this.totalSheets/4),o.apply(this,[t])};s.extends(r,o),r.prototype.draw=function(t){var e=this,i=t.pageNum,s=t.isLeftToRight,o=53.975,r=5,a=107.95,h=17,d=3,p=1,l=16,u={size:12,draw:function(t,s){e.pdf.text("Page ",t,s),t+=10.9,e.pdf.text(String(i),t,s-1),t+=n.getTextWidth(String(i),this.size),e.pdf.text("/",t,s),t+=1.2,e.pdf.text(String(e.totalPages),t,s+1)}},f={marginX:10,marginY:3,size:28,sheet:4*(i-1)+1,getTop:function(){return this.marginY+this.height},getBottom:function(){return this.getTop()+139.7},getLeft:function(){return this.marginX},getRight:function(){return 215.9-n.getTextWidth("SS "+this.sheet,this.size)-f.marginX},hasNext:function(){return++this.sheet<=e.totalSheets},draw:function(t,i){e.pdf.text("SS "+this.sheet,t,i)}};this.pdf.rect(o,r,a,h),this.pdf.setFontSize(l),this.pdf.text(this.title,107.95-n.getTextWidth(this.title,l)/2,r+p+n.getTextHeight(l)),this.pdf.setFontSize(l-3),this.pdf.text(this.dotLabel,107.95-n.getTextWidth(this.dotLabel,l)/2,r+p+2*n.getTextHeight(l)),this.pdf.setFontSize(u.size);var c=o+d,g=r+h/2+n.getTextHeight(u.size)/2;u.draw(c,g),c=161.925-d-n.getTextWidth("Page 0/0",u.size),u.draw(c,g),f.height=n.getTextHeight(f.size),f.width=n.getTextWidth("SS 00",f.size)+f.marginX,this.pdf.setFontSize(f.size),f.draw(f.getLeft(),f.getTop()),f.hasNext()&&(s?f.draw(f.getRight(),f.getTop()):f.draw(f.getLeft(),f.getBottom())),f.hasNext()&&(s?f.draw(f.getLeft(),f.getBottom()):f.draw(f.getRight(),f.getTop())),f.hasNext()&&f.draw(f.getRight(),f.getBottom())},t.exports=r},763:(t,e,i)=>{var s=i(730),n=i(925),o=i(642),r=function(t){o.apply(this,[t])};s.extends(r,o),r.prototype.draw=function(t,e,i,s,o){var r=this._getContinuityTexts(o.dot),a=n.getTextHeight(10),h=e+1,d=t+2,p=0,l=0;this.pdf.rect(t,e,i,s),this.pdf.setFontSize(10);for(var u=0;u<r.length;u++){var f=r[u],c=n.getTextWidth(f,10);if(c>p&&(p=c),(l+=a+.7)>s-a-1){if(!(p<i/2&&d<i/2)){this.pdf.text("...",d,h+l-a/2);break}d+=i/2,l=a+.7}this.pdf.text(f,d,h+l)}var g=o.duration+" beats total";this.pdf.text(g,t+i/2-n.getTextWidth(g,10)/2-3,e+s-1),this.pdf.resetFormat()},r.prototype._getContinuityTexts=function(t){var e=[];return t.getMovementCommands().forEach((function(t){var i=t.getContinuityText();""!==i&&e.push(i)})),e},t.exports=r},370:(t,e,i)=>{var s=i(730),n=i(925),o=i(642),r=function(t,e){this.westUp="west"==e,o.apply(this,[t])};s.extends(r,o),r.prototype.draw=function(t,e,i,s,o){var r=this,a=o.movements,h=n.getTextWidth("S",n.DEFAULT_FONT_SIZE),d=n.getTextHeight(n.DEFAULT_FONT_SIZE),p={x:t,y:o.minimal?e+d:e,width:i-2*(h+2),height:s-2*d};p.x+=i/2-p.width/2,p.y+=s/2-p.height/2,o.minimal&&(p.y-=d),this._drawBox(p.x,p.y,p.width,p.height,this.westUp,o.minimal);var l=a[0].startPosition,u={startX:l.x,startY:l.y,minX:0,minY:0,maxX:0,maxY:0,deltaX:0,deltaY:0,width:20,height:p.height/p.width*20,update:function(t,e){this.deltaX+=t,this.deltaY+=e,this.deltaX<this.minX?this.minX=this.deltaX:this.deltaX>this.maxX&&(this.maxX=this.deltaX),this.deltaY<this.minY?this.minY=this.deltaY:this.deltaY>this.maxY&&(this.maxY=this.deltaY)},getOverallX:function(){return this.maxX-this.minX},getOverallY:function(){return this.maxY-this.minY},scale:function(){var t=this.getOverallX(),e=this.getOverallY();t>this.width-4&&(this.width=t+4,this.height=p.height/p.width*this.width),e>this.height-4&&(this.height=e+4,this.width=p.width/p.height*this.height)}};a.forEach((function(t){u.update(t.deltaX,t.deltaY)})),u.scale();var f,c,g,_=p.width/u.width,v=u.startX+u.maxX-u.getOverallX()/2-u.width/2,x=u.startY+u.maxY-u.getOverallY()/2-u.height/2,y=v+u.width,m=x+u.height;this.westUp?(f=x,c=v,g=y,Math.ceil(c/8)):(f=m,c=y,g=v,Math.floor(c/8));var w={east:m,west:x,south:v,north:y,westUp:this.westUp};this._drawYardlines(p,w,_);var S=p.x+Math.abs(c-u.startX)*_,T=p.y+Math.abs(f-u.startY)*_,b=p.height/15,M=this.westUp?1:-1;this.pdf.setLineWidth(.5),this.pdf.circle(S,T,b),this._drawPosition(p,u.startY,T-p.y,Math.abs(c-u.startX)<Math.abs(c-g)/2),this.pdf.setLineWidth(.75),a.forEach((function(t){var e=M*t.deltaX*_,i=M*t.deltaY*_;r.pdf.line(S,T,S+e,T+i),S+=e,T+=i})),this.pdf.setLineWidth(.5),this.pdf.line(S-b,T-b,S+b,T+b),this.pdf.line(S+b,T-b,S-b,T+b),0!=u.deltaY&&this._drawPosition(p,u.startY+u.deltaY,T-p.y,Math.abs(c-u.startX-u.deltaX)<Math.abs(c-g)/2),this.pdf.resetFormat()},r.prototype._drawPosition=function(t,e,i,s){var o=t.y+i,r=n.getYCoordinateText(e);this.pdf.setFontSize(8),s?this.pdf.text(r,t.x+t.width-n.getTextWidth(r,8)-.5,o-.5):this.pdf.text(r,t.x+.5,o-.5),this.pdf.resetFormat()},t.exports=r},905:(t,e,i)=>{var s=i(925),n=i(519),o=i(705),r=i(763),a=i(370),h=i(707),d=i(630),p=10,l=[{x:p,y:24},{x:117.95,y:24},{x:p,y:155.7},{x:117.95,y:155.7}],u=139.7-22,f=function(t,e){this.pdf=jsPDF("portrait","mm","letter"),this.show=t,this.dots=e,this.sheets=t.getSheets(),this.data=null,this.current=0,this.total=this.dots.length*this.sheets.length};f.prototype.generate=function(t){for(var e=Math.ceil(this.sheets.length/4)+2,i=0;i<this.dots.length;i++)0!==i&&this.pdf.addPage(),this.dot=this.dots[i],this._generate(t),e%2==1&&i<this.dots.length-1&&this.pdf.addPage();this.data=this.pdf.output("datauristring")},f.prototype._generate=function(t){this.headerWidget=new n(this.pdf,{dotLabel:this.dot,title:this.show.getTitle(),totalSheets:this.sheets.length}),this.dotContinuityWidget=new o(this.pdf),this.individualContinuityWidget=new r(this.pdf),this.movementDiagramWidget=new a(this.pdf,t["md-orientation"]),this.birdsEyeWidget=new h(this.pdf,t["bev-orientation"]),this.surroundingDotsWidget=new d(this.pdf,t["sd-orientation"]),this._addFrontSheet();for(var e=this._getMovements(),i=0;i<Math.ceil(this.sheets.length/4);i++){this.pdf.addPage();for(var s=[],p=0;p<4&&(c=4*i+p)!=this.sheets.length;p++)s.push(this.sheets[c]);this.headerWidget.draw({pageNum:i+1,isLeftToRight:"ltr"===t["layout-order"]}),this.pdf.setDrawColor(150),this.pdf.vLine(107.95,24,279.4-24),this.pdf.hLine(0,142.2,215.9),this.pdf.setDrawColor(0);var f=[0,1,2,3];for("ttb"===t["layout-order"]&&(f=[0,2,1,3]),p=0;p<s.length;p++){var c,g=l[f[p]].x,_=l[f[p]].y,v=(c=s[p]).getDotByLabel(this.dot);this.dotContinuityWidget.draw(g,_,87.95,u/6,{sheet:c,dotType:c.getDotType(this.dot)}),this.individualContinuityWidget.draw(g,_+u/6,43.975,39.23333333333333,{dot:v,duration:c.getDuration()}),this.movementDiagramWidget.draw(g+43.975+1,_+u/6,43.975,39.23333333333333,{movements:e[4*i+p]}),this.surroundingDotsWidget.draw(g,_+u/2+2,87.95,56.849999999999994,{sheet:c,dot:v}),this.current++;var x=this.current/this.total;$(".js-pdf-loading .progress-bar").css({width:50+50*x+"%"})}}this._addEndSheet(e)},f.prototype._getMovements=function(){var t=[],e=this.dot;return this.sheets.forEach((function(i){var s=[],n=i.getDotByLabel(e).getMovementCommands(),o=n[0].getStartPosition();n.forEach((function(t){var e=t.getEndPosition();void 0===t.getMiddlePoints?s.push({startPosition:o,deltaX:e.x-o.x,deltaY:e.y-o.y}):t.getMiddlePoints().forEach((function(t){s.push({startPosition:o,deltaX:t[0],deltaY:t[1]})})),o=e})),t.push(s)})),t},f.prototype._addFrontSheet=function(){this.pdf.vLine(107.95,10,269.4);var t=this.show.getTitle()+" - Dot "+this.dot;this.pdf.setFontSize(15),this.pdf.text(t,107.95-s.getTextWidth(t,15)/2,8),s.getTextHeight(10);for(var e=s.getTextWidth("00",20)+4,i=s.getTextHeight(20),n=107.95-e-6-p,o=84*n/160,r=0,a=10,h=0;h<this.sheets.length;h++){var d=this.sheets[h],l=d.getDotByLabel(this.dot);a+o>274.4&&(0===r?r=99.95:(this.pdf.addPage(),this.pdf.vLine(107.95,10,269.4),this.pdf.setFontSize(15),this.pdf.text(t,107.95-s.getTextWidth(t,15)/2,8),r=0),a=10),this.pdf.setFontSize(20),this.pdf.text(String(h+1),r+2+p,a+.5+i);var u={sheet:d,dot:l,minimal:!0};this.birdsEyeWidget.draw(r+e+2+p,a+.5,n,o,u),a+=o+1}},f.prototype._addEndSheet=function(t){this.pdf.addPage(),this.pdf.vLine(107.95,10,269.4);var e=this.show.getTitle()+" - Dot "+this.dot;this.pdf.setFontSize(15),this.pdf.text(e,107.95-s.getTextWidth(e,15)/2,8);for(var i=s.getTextHeight(10),n=s.getTextWidth("00",20)+4,o=s.getTextHeight(20),r=77.95-n-6-p,a=0,h=10,d=0;d<this.sheets.length;d++){var l=this.sheets[d],u=l.getDotByLabel(this.dot),f=25,c=(u.getMovementCommands().length+1)*(i+1)+1;c>f&&(f=c),h+f>274.4&&(0==a?a=99.95:(this.pdf.addPage(),this.pdf.vLine(107.95,10,269.4),this.pdf.setFontSize(15),this.pdf.text(e,107.95-s.getTextWidth(e,15)/2,8),a=0),h=10),this.pdf.setFontSize(20),this.pdf.text(String(d+1),a+2+p,h+.5+o),this.individualContinuityWidget.draw(a+n+2+p,h+.5,r,f,{dot:u,duration:this.sheets[d].getDuration()});var g={sheet:l,dot:u,minimal:!0,movements:t[d]};this.movementDiagramWidget.draw(a+n+r+2+p,h+.5,30,f,g),h+=f+1}},t.exports=f},925:t=>{PDFUtils={},PDFUtils.DUMMY_PDF=jsPDF("portrait","mm","letter"),PDFUtils.SCALE_FACTOR=PDFUtils.DUMMY_PDF.internal.scaleFactor,PDFUtils.DEFAULT_FONT_SIZE=12,PDFUtils.getTextWidth=function(t,e){return this.DUMMY_PDF.getStringUnitWidth(t)*e/this.SCALE_FACTOR},PDFUtils.getTextHeight=function(t){return t/this.SCALE_FACTOR},PDFUtils.getXCoordinateText=function(t){var e=t%8,i=5*Math.floor(t/8);return e>4&&(i+=5),i=i<50?"S"+i:50==i?"50":"N"+(100-i),e>4?(e=8-e,(e=Math.round(10*e)/10)+"S "+i):0==e?i:(e=Math.round(10*e)/10)+"N "+i},PDFUtils.getYCoordinateText=function(t){function e(t){return Math.round(10*t)/10}return 0==t?"WS":t<=16?e(t)+" WS":t<32?e(32-t)+"W WH":32==t?"WH":t<=40?e(t-32)+"E WH":t<52?e(52-t)+"W EH":52==t?"EH":t<=68?e(t-52)+"E EH":t<84?e(84-t)+" ES":"ES"},function(t){"use strict";t.drawDot=function(t,e,i,s){return this.setLineWidth(.1),-1!=t.indexOf("open")?(this.setFillColor(255),this.circle(e,i,s,"FD")):(this.setFillColor(0),this.circle(e,i,s,"FD")),s+=.1,-1==t.indexOf("backslash")&&-1==t.indexOf("x")||this.line(e-s,i-s,e+s,i+s),-1==t.indexOf("forwardslash")&&-1==t.indexOf("x")||this.line(e-s,i+s,e+s,i-s),this.setLineWidth(.3),this.setFillColor(0),this},t.resetFormat=function(){return this.setFontSize(PDFUtils.DEFAULT_FONT_SIZE),this.setFontStyle("normal"),this.setTextColor(0),this.setDrawColor(0),this.setFillColor(255),this.setLineWidth(.3),this},t.hLine=function(t,e,i){this.line(t,e,t+i,e)},t.vLine=function(t,e,i){this.line(t,e,t,e+i)}}(jsPDF.API),t.exports=PDFUtils},642:(t,e,i)=>{var s=i(925),n=function(t){this.pdf=t};n.prototype.draw=function(t,e,i,s,n){console.log("draw called")},n.prototype._drawBox=function(t,e,i,n,o,r){var a,h,d,p,l=s.getTextHeight(s.DEFAULT_FONT_SIZE),u=s.getTextWidth("S",s.DEFAULT_FONT_SIZE);o?(a="W",h="E",d="S",p="N"):(a="E",h="W",d="N",p="S"),this.pdf.setFontSize(s.DEFAULT_FONT_SIZE),r||(this.pdf.text(a,t+i/2-u/2-.5,e-2),this.pdf.text(h,t+i/2-u/2-.5,e+n+l)),this.pdf.text(d,t-u-1,e+n/2+l/2),this.pdf.text(p,t+i+1,e+n/2+l/2),this.pdf.rect(t,e,i,n),this.pdf.resetFormat()},n.prototype._drawYardlines=function(t,e,i){var n=12*t.height/47.1;this.pdf.setFontSize(n);var o,r,a,h=e.west<52&&e.east>52,d=e.west<32&&e.east>32;e.westUp?(o=t.y+(52-e.west)*i,r=t.y+(32-e.west)*i,a=5*Math.ceil(e.south/8),e.left=e.south):(o=t.y+(e.east-52)*i,r=t.y+(e.east-32)*i,a=5*Math.floor(e.north/8),e.left=e.north);for(var p=e.westUp?e.west:e.east,l=e.westUp?Math.ceil(p/4):Math.floor(p/4),u=e.westUp?-1:1,f=Math.abs(4*l-p),c=i*Math.max(0,e.north-160),g=i*Math.min(0,e.south),_=e.westUp?g:c,v=e.westUp?c:g;i*f<t.height;f+=4){var x=p-u*f;x<0||x>84||(x%84==0?this.pdf.setDrawColor(0):this.pdf.setDrawColor(200),this.pdf.hLine(t.x,t.y+f*i+_,t.width+u*(v-_)))}var y=Math.abs(8*a/5-e.left)*i,m=!1;y>4*i&&(y-=4*i,m=!0);var w=this,S=i*Math.max(0,e.east-84),T=i*Math.min(0,e.west),b=e.westUp?T:S,M=e.westUp?S:T,D=(u=e.westUp?-1:1,function(e){w.pdf.vLine(e,t.y+b,t.height+u*(M-b))});for(this.pdf.setTextColor(150);y<t.width;y+=4*i,m=!m){var F=t.x+y;if(m)this.pdf.setDrawColor(200),D(F);else{this.pdf.setDrawColor(0),D(F),d&&this.pdf.hLine(F-1.5,r,3),h&&this.pdf.hLine(F-1.5,o,3);var P="";1===(P=String(a<50?a:100-a)).length&&(P="0"+P);var A=s.getTextWidth(P,n)/2;if(y>A&&this.pdf.text(P[0],F-A-.5,t.y+t.height-2),y<t.width-A&&this.pdf.text(P[1],F+.5,t.y+t.height-2),(a+=e.westUp?5:-5)<0||a>100)break}}this.pdf.resetFormat()},t.exports=n},630:(t,e,i)=>{var s=i(730),n=i(925),o=i(642);FONT_SIZE=7,DOT_RADIUS=1;var r=function(t,e){this.westUp="west"===e,o.apply(this,[t])};s.extends(r,o),r.prototype.draw=function(t,e,i,s,o){var r=this,a=n.getTextWidth("S",FONT_SIZE),h=n.getTextHeight(FONT_SIZE),d={x:t,y:e,width:i-2*(a+2),height:s-2*(h+2)};d.x+=i/2-d.width/2,d.y+=s/2-d.height/2,o.minimal&&(d.y-=h),this._drawBox(d.x,d.y,d.width,d.height,this.westUp,o.minimal);var p=d.x+d.width/2,l=d.y+d.height/2,u=o.sheet,f=o.dot.getAnimationState(0),c=this.westUp?1:-1,g=d.height/19.5,_=(this.westUp,f.x,{east:f.y+d.height/2/g,west:f.y-d.height/2/g,north:f.x+d.width/2/g,south:f.x-d.width/2/g,westUp:this.westUp});this._drawYardlines(d,_,g),this.pdf.setFontSize(FONT_SIZE),u.getDots().forEach((function(t){var e=t.getAnimationState(0),i=c*(e.x-f.x),s=c*(e.y-f.y);if(!(Math.abs(i)>14||Math.abs(s)>8)){var n=t.getLabel();0===i&&0===s?r.pdf.setFontStyle("bold"):r.pdf.setFontStyle("normal");var o=i*g+p,a=s*g+l;r.pdf.drawDot(u.getDotType(n),o,a,DOT_RADIUS),r.pdf.text(n,o-2*DOT_RADIUS,a-1.5*DOT_RADIUS)}})),this.pdf.resetFormat()},t.exports=r},341:t=>{t.exports=function(t,e,i){this.x=t,this.y=e,this.angle=i}},532:t=>{t.exports=function(t,e){this.x=t,this.y=e}},787:t=>{var e=function(t,e){this._label=t,this._movements=e};e.prototype.getLabel=function(){return this._label},e.prototype.getMovementCommands=function(){return this._movements},e.prototype.getAnimationState=function(t){for(var e=0;e<this._movements.length;e++){if(t<this._movements[e].getBeatDuration())return this._movements[e].getAnimationState(t);t-=this._movements[e].getBeatDuration()}},t.exports=e},286:(t,e,i)=>{var s=i(532),n=function(t,e,i,s,n){this._startX=t,this._startY=e,this._endX=i,this._endY=s,this._numBeats=n};n.prototype.getStartPosition=function(){return new s(this._startX,this._startY)},n.prototype.getEndPosition=function(){return new s(this._endX,this._endY)},n.prototype.getBeatDuration=function(){return this._numBeats},n.prototype.getAnimationState=function(t){console.log("getAnimationState called")},n.prototype.getContinuityText=function(){console.log("getContinuityText called")},n.prototype.getOrientation=function(){switch(this._orientation){case 0:return"E";case 90:return"S";case 180:return"W";case 270:return"N";default:return""}},t.exports=n},88:(t,e,i)=>{var s=i(730),n=i(581),o=i(286),r=i(341),a=function(t,e,i,s,r,a,h,d){this._beatsPerStep=d,this._centerX=i,this._centerY=s,this._radius=n.calcDistance(t,e,this._centerX,this._centerY),this._startAngle=n.calcAngleAbout(t,e,i,s),isNaN(this._startAngle)&&(this._startAngle=0),this._stepAngleDelta=n.toRadians(r)/Math.floor(h/this._beatsPerStep),this._movementIsCW=this._stepAngleDelta>=0,this._orientationOffset=n.toRadians(a);var p=this.getAnimationState(h);o.apply(this,[t,e,p.x,p.y,h])};s.extends(a,o),a.prototype.getAnimationState=function(t){var e=Math.floor(t/this._beatsPerStep),i=this._startAngle+this._stepAngleDelta*e,s=this._radius*n.calcRotatedXPos(i)+this._centerX,o=this._radius*n.calcRotatedYPos(i)+this._centerY,a=n.quarterTurn(i,this._movementIsCW)+this._orientationOffset;return new r(s,o,n.toDegrees(a))},a.prototype.getMiddlePoints=function(){for(var t=this._startAngle,e=this._startX,i=this._startY,s=[],o=0;o<this._numBeats/this._beatsPerStep;o++){t+=this._stepAngleDelta;var r=this._radius*n.calcRotatedXPos(t)+this._centerX,a=this._radius*n.calcRotatedYPos(t)+this._centerY;s.push([r-e,a-i]),e=r,i=a}return s},a.prototype.getContinuityText=function(){var t=this._numBeats/this._beatsPerStep;return"GT "+(this._movementIsCW?"CW":"CCW")+" "+Math.abs(Math.floor(n.toDegrees(this._numBeats*this._stepAngleDelta)))+" deg. ("+t+" steps)"},t.exports=a},736:(t,e,i)=>{var s=i(730),n=i(286),o=i(341),r=function(t,e,i,s){this._orientation=i,n.apply(this,[t,e,t,e,s])};s.extends(r,n),r.prototype.getAnimationState=function(t){return new o(this._startX,this._startY,this._orientation)},r.prototype.getContinuityText=function(){return"Close "+this.getOrientation()},t.exports=r},282:(t,e,i)=>{var s=i(730),n=i(286),o=i(341),r=function(t,e,i,s,o,r,a){this._orientation=o,this._beatsPerStep=a;var h=Math.floor(r/this._beatsPerStep);this._deltaXPerStep=(i-t)/h,this._deltaYPerStep=(s-e)/h,n.apply(this,[t,e,i,s,r])};s.extends(r,n),r.prototype.getAnimationState=function(t){var e=Math.floor(t/this._beatsPerStep);return new o(this._startX+this._deltaXPerStep*e,this._startY+this._deltaYPerStep*e,this._orientation)},r.prototype.getBeatsPerStep=function(){return this._beatsPerStep},r.prototype.getContinuityText=function(){var t=this._endX-this._startX,e=this._endY-this._startY,i=t<0?"S":"N",s=e<0?"W":"E",n=this._numBeats/this._beatsPerStep;if(t=Math.abs(t),e=Math.abs(e),0==t&&e==n)return"Move "+n+" "+s;if(0==e&&t==n)return"Move "+n+" "+i;if(e==t&&t==n)return"Move "+n+" "+i+s;var o="Even ";if(t%1!=0||e%1!=0)o+=0!=t?i:"",o+=0!=e?s:"";else{var r=[];0!=e&&r.push(Math.abs(e)+" "+s),0!=t&&r.push(Math.abs(t)+" "+i),o+=r.join(", ")}return"Even "===o&&(o+="0"),o+" ("+n+" steps)"},t.exports=r},353:(t,e,i)=>{var s=i(730),n=i(286),o=i(341),r=function(t,e,i,s,o,r){this._orientation=o,n.apply(this,[t,e,i,s,r])};s.extends(r,n),r.prototype.getAnimationState=function(t){return new o(this._endX,this._endY,this._orientation)},r.prototype.getContinuityText=function(){return"See Continuity ("+this._numBeats+" beats)"},t.exports=r},290:(t,e,i)=>{var s=i(730),n=i(286),o=i(341),r=function(t,e,i,s){this._orientation=i,n.apply(this,[t,e,t,e,s])};s.extends(r,n),r.prototype.getAnimationState=function(t){return new o(this._startX,this._startY,this._orientation)},r.prototype.getContinuityText=function(){return 0==this._numBeats?"":"MT "+this._numBeats+" "+this.getOrientation()},t.exports=r},27:(t,e,i)=>{var s=i(730),n=i(581),o=i(286),r=i(341),a=function(t,e,i,s,r,a,h){s=n.toRadians(s),this._deltaXPerStep=n.calcRotatedXPos(s)*i,this._deltaYPerStep=n.calcRotatedYPos(s)*i,this._orientation=r,this._beatsPerStep=h,numSteps=Math.floor(a/this._beatsPerStep),o.apply(this,[t,e,t+this._deltaXPerStep*numSteps,e+this._deltaYPerStep*numSteps,a])};s.extends(a,o),a.prototype.getAnimationState=function(t){return numSteps=Math.floor(t/this._beatsPerStep),new r(this._startX+this._deltaXPerStep*numSteps,this._startY+this._deltaYPerStep*numSteps,this._orientation)},a.prototype.getContinuityText=function(){var t=this._endX-this._startX,e=this._endY-this._startY,i=t<0?"S":"N",s=e<0?"W":"E";return 0==t?"Move "+Math.abs(e)+" "+s:"Move "+Math.abs(t)+" "+i},t.exports=a},408:(t,e,i)=>{var s=i(730),n=i(286),o=i(341),r=function(t,e,i,s){this._orientation=i,n.apply(this,[t,e,t,e,s])};s.extends(r,n),r.prototype.getAnimationState=function(t){return new o(this._startX,this._startY,this._orientation)},r.prototype.getContinuityText=function(){return"Stand & Play "+this._numBeats+this.getOrientation()},t.exports=r},427:t=>{var e=function(t,e,i,s,n,o,r,a){this._sheetLabel=t,this._fieldType=e,this._dotTypes=i,this._dotTypeAssignments=s,this._continuityTexts=n,this._duration=o,this._dots=r,this._dotLabels=a};e.prototype.getSheetLabel=function(){return this._sheetLabel},e.prototype.getFieldType=function(){return this._fieldType},e.prototype.getAllDotTypes=function(){return this._dotTypes},e.prototype.getDotType=function(t){return this._dotTypeAssignments[t]},e.prototype.getContinuityTexts=function(t){return this._continuityTexts[t]},e.prototype.getDots=function(){return this._dots},e.prototype.getDotByLabel=function(t){var e=this._dotLabels.indexOf(t);return-1===e?null:this._dots[e]},e.prototype.getDuration=function(){return this._duration},t.exports=e},143:t=>{var e=function(t,e,i,s,n){this._title=t,this._year=e,this._description=i,this._dotLabels=s,this._sheets=void 0===n?[]:n};e.prototype.getTitle=function(){return this._title},e.prototype.getYear=function(){return this._year},e.prototype.getDescription=function(){return this._description},e.prototype.getDotLabels=function(){return this._dotLabels},e.prototype.getSheets=function(){return this._sheets},e.prototype.getSheet=function(t){return this._sheets[t]},e.prototype.getNumSheets=function(){return this._sheets.length},e.prototype.appendSheet=function(t){this._sheets.push(t)},t.exports=e},832:t=>{var e=function(t,e,i){this._major=t,this._minor=e,this._revision=i};e.prototype.stringify=function(){return this._major+"."+this._minor+"."+this._revision},e.prototype.compareTo=function(t){var e=this._major-t._major;return 0!=e||0!=(e=this._minor-t._minor)?e:e=this._revision-t._revision},e.parse=function(t){var i=t.split(".");return new e(parseInt(i[0]),parseInt(i[1]),parseInt(i[2]))},t.exports=e},976:(t,e,i)=>{var s=i(154),n=(i(832),function(){this._loaders=[]});n.prototype.registerLoader=function(t,e){var i=s.binarySearchForClosestLarger(this._loaders,t,n._versionLocator),o={version:t,loader:e};this._loaders.splice(i,0,o)},n.prototype.getAppropriateLoader=function(t){var e=s.binarySearchForClosestSmaller(this._loaders,t,n._versionLocator);return this._loaders[e].loader},n._versionLocator=function(t,e){return t.compareTo(e.version)},(n.FileLoader=function(){}).prototype.loadFile=function(t){console.log("FileLoader.loadFile(...) called")},t.exports=n},530:t=>{t.exports=function(t){this.message=t,this.name="InvalidFileTypeError"}},590:(t,e,i)=>{var s=i(976),n=i(530),o=i(730),r=i(832),a=i(787),h=i(427),d=i(143),p=i(408),l=i(736),u=i(290),f=i(88),c=i(27),g=i(353),_=i(282),v=function(){s.apply(this,[])};o.extends(v,s),v._instance=void 0,v.getInstance=function(){return void 0===v._instance&&(v._instance=new v,v._setupInstance(v._instance)),v._instance},v._setupInstance=function(t){t.registerLoader(new r(1,0,0),new x)},v.ViewerFileLoader=function(){},o.extends(v.ViewerFileLoader,s.FileLoader);var x=function(){};o.extends(x,v.ViewerFileLoader),x.prototype.loadFile=function(t){return this.loadShow(t.show)},x.prototype.loadShow=function(t){if(void 0===t)throw new n("Please upload a proper viewer file.");var e=new d(t.title,t.year,t.description,t.labels);return this.loadSheets(e,t.sheets),e},x.prototype.loadSheets=function(t,e){for(var i=0;i<e.length;i++)t.appendSheet(this.buildIndividualSheet(e[i]))},x.prototype.buildIndividualSheet=function(t){return new h(t.label,t.field_type,t.dot_types,t.dot_labels,t.continuities,t.beats,this.buildDots(t.movements),Object.keys(t.movements))},x.prototype.buildDots=function(t){var e=[];for(var i in t)e.push(new a(i,this.buildDotMovements(t[i])));return e},x.prototype.buildDotMovements=function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.buildIndividualMovement(t[i]));return e},x.prototype.buildIndividualMovement=function(t){switch(t.type){case"stand":return this.buildStandMovement(t);case"close":return this.buildCloseMovement(t);case"mark":return this.buildMarkMovement(t);case"move":return this.buildMoveMovement(t);case"goto":return this.buildGotoMovement(t);case"arc":return this.buildArcMovement(t);case"even":return this.buildEvenMovement(t);default:throw new TypeError("Movement type unrecognized.")}},x.prototype.buildStandMovement=function(t){return new p(t.x,t.y,t.facing,t.beats)},x.prototype.buildCloseMovement=function(t){return new l(t.x,t.y,t.facing,t.beats)},x.prototype.buildMarkMovement=function(t){return new u(t.x,t.y,t.facing,t.beats)},x.prototype.buildMoveMovement=function(t){return new c(t.start_x,t.start_y,t.step_size,t.direction,t.facing,t.beats,t.beats_per_step)},x.prototype.buildGotoMovement=function(t){return new g(t.from_x,t.from_y,t.to_x,t.to_y,t.facing,t.beats)},x.prototype.buildArcMovement=function(t){return new f(t.start_x,t.start_y,t.center_x,t.center_y,t.angle,t.facing_offset,t.beats,t.beats_per_step)},x.prototype.buildEvenMovement=function(t){return new _(t.x1,t.y1,t.x2,t.y2,t.facing,t.beats,t.beats_per_step)},t.exports=v},154:t=>{var e={binarySearchBase:function(t,e){for(var i,s,n,o,r=t.length,a=0;r>0&&0!==(s=e(t[n=a+(i=Math.floor(r/2))],n));)s>0?(a+=o=i+1,r-=o):r=i},binarySearchForClosestLarger:function(t,i,s){var n;return e.binarySearchBase(t,(function(t,e){var o=s(i,t);return o<=0&&(n=e),o})),n},binarySearchForClosestSmaller:function(t,i,s){var n;return e.binarySearchBase(t,(function(t,e){var o=s(i,t);return o>=0&&(n=e),o})),n},binarySearch:function(t,i,s){var n;return e.binarySearchBase(t,(function(t,e){var o=s(i,t);return 0===o&&(n=e),o})),n},mergeSortedArrays:function(t,e,i){for(var s=0,n=0,o=[];s<t.length&&n<e.length;)i(t[s],e[n])<0?(o.push(t[s]),s++):(o.push(e[n]),n++);for(;s<t.length;s++)o.push(t[s]);for(;n<e.length;n++)o.push(e[n]);return o}};t.exports=e},730:t=>{var e={extends:function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i},getURLValue:function(t){var e=this.getAllURLParams();return void 0!==e[t]?e[t]:null},getAllURLParams:function(){for(var t={},e=window.location.search.substr(1).split("&"),i=0;i<e.length;i++){var s=e[i].split("="),n=decodeURIComponent(s[0]),o=decodeURIComponent(s[1]);t[n]=o}return t}};t.exports=e},581:t=>{MathUtils={},MathUtils.PI_OVER_TWO=Math.PI/2,MathUtils.TWO_PI=2*Math.PI,MathUtils.DEGREES_TO_RADIANS_CONV_FACTOR=Math.PI/180,MathUtils.RADIANS_TO_DEGREES_CONV_FACTOR=1/MathUtils.DEGREES_TO_RADIANS_CONV_FACTOR,MathUtils.calcSquaredDistance=function(t,e,i,s){var n=i-t,o=s-e;return n*n+o*o},MathUtils.calcDistance=function(t,e,i,s){return Math.sqrt(this.calcSquaredDistance(t,e,i,s))},MathUtils.calcAngle=function(t,e){var i=Math.atan(-t/e);return e<0&&(i+=Math.PI),i},MathUtils.calcAngleAbout=function(t,e,i,s){return this.calcAngle(t-i,e-s)},MathUtils.calcRotatedXPos=function(t){return-Math.sin(t)},MathUtils.calcRotatedYPos=function(t){return Math.cos(t)},MathUtils.quarterTurn=function(t,e){return t+(2*e-1)*this.PI_OVER_TWO},MathUtils.wrapAngleDegrees=function(t){for(;t>=360;)t-=360;for(;t<0;)t+=360;return t},MathUtils.wrapAngleRadians=function(t){for(;t>=TWO_PI;)t-=this.TWO_PI;for(;t<0;)t+=this.TWO_PI;return t},MathUtils.toRadians=function(t){return t*this.DEGREES_TO_RADIANS_CONV_FACTOR},MathUtils.toDegrees=function(t){return t*this.RADIANS_TO_DEGREES_CONV_FACTOR},t.exports=MathUtils},836:(t,e,i)=>{var s=i(590),n=i(832),o={fromJSONString:function(t){var e=JSON.parse(t);return this.fromJSON(e)},fromJSON:function(t){var e=n.parse(t.meta.version);return s.getInstance().getAppropriateLoader(e).loadFile(t)}};t.exports=o}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s](o,o.exports,i),o.exports}(()=>{var t=i(905),e=i(836),s=i(730).getAllURLParams();s.dots=s.dots?s.dots.split(","):[];var n=["md-orientation","bev-orientation","sd-orientation","layout-order"];function o(t){$(".js-pdf-loading h1").addClass("error").text(t),$(".js-pdf-loading .progress-bar").remove()}function r(){window.location.search=$.map(s,(function(t,e){return"dots"===e&&(t=t.join(",")),e+"="+t})).join("&")}$(document).ready((function(){if(s.show){n.forEach((function(t){var e=$(".pdf-option input[name="+t+"]"),i=e.filter("[value="+s[t]+"]");void 0===s[t]||0===i.length?e.filter(":first").prop("checked",!0):i.prop("checked",!0)})),$("input").change((function(){s[$(this).attr("name")]=$(this).val(),r()})),$(".js-choose-dots").click((function(){var t=$(".dot-labels").val();if(0!==t.length){t=t.split("\n");for(var e=$(".dot-labels").data("labels"),i=0;i<t.length;i++){var n=t[i];if(-1===e.indexOf(n))return void alert("Dot "+n+" does not exist!")}s.dots=t,r()}}));var i=s.dots[0]||"",a="index.html?show="+s.show+"&dot="+i;$(".back-link").attr("href",a),$.ajax({url:"https://calchart-server.herokuapp.com/viewer/"+s.show+"/",dataType:"text",xhr:function(){var t=$.ajaxSettings.xhr();return t.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total;$(".js-pdf-loading .progress-bar").css({width:50*e+"%"})}},t},success:function(i){$(".js-pdf-loading .progress-bar").css("width","50%");var n=e.fromJSONString(i);if($(".dot-labels").data("labels",n.getDotLabels()),$(".js-choose-dots").prop("disabled",!1),0!==s.dots.length){window.generator=new t(n,s.dots);try{window.generator.generate(s)}catch(t){throw o("An error occurred."),t}!function(){$(".js-pdf-preview").remove(),$(".js-pdf-loading h1").remove(),$(".js-pdf-loading .progress-bar").remove();var t=$('<h1 class="download-link">').text("Download here").attr("href","#").click((function(){return window.generator.pdf.save(),!1}));$("<h1>").append(t).appendTo(".js-pdf-loading")}()}else o("No dot selected.")},error:function(){o("Could not reach server.")}})}else o("No show selected.")}))})()})();