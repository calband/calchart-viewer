!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=35)}([function(t,e){var i={extends:function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i},getURLValue:function(t){var e=this.getAllURLParams();return void 0!==e[t]?e[t]:null},getAllURLParams:function(){for(var t={},e=window.location.search.substr(1).split("&"),i=0;i<e.length;i++){var n=e[i].split("="),s=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]);t[s]=o}return t}};t.exports=i},function(t,e,i){var n=i(16),s=function(t,e,i,n,s){this._startX=t,this._startY=e,this._endX=i,this._endY=n,this._numBeats=s};s.prototype.getStartPosition=function(){return new n(this._startX,this._startY)},s.prototype.getEndPosition=function(){return new n(this._endX,this._endY)},s.prototype.getBeatDuration=function(){return this._numBeats},s.prototype.getAnimationState=function(t){console.log("getAnimationState called")},s.prototype.getContinuityText=function(){console.log("getContinuityText called")},s.prototype.getOrientation=function(){switch(this._orientation){case 0:return"E";case 90:return"S";case 180:return"W";case 270:return"N";default:return""}},t.exports=s},function(t,e){t.exports=function(t,e,i){this.x=t,this.y=e,this.angle=i}},function(t,e){var i=function(t,e,i){this._major=t,this._minor=e,this._revision=i};i.prototype.stringify=function(){return this._major+"."+this._minor+"."+this._revision},i.prototype.compareTo=function(t){var e=this._major-t._major;return 0!=e?e:0!=(e=this._minor-t._minor)?e:e=this._revision-t._revision},i.parse=function(t){var e=t.split(".");return new i(parseInt(e[0]),parseInt(e[1]),parseInt(e[2]))},t.exports=i},function(t,e){PDFUtils={},PDFUtils.DUMMY_PDF=jsPDF("portrait","mm","letter"),PDFUtils.SCALE_FACTOR=PDFUtils.DUMMY_PDF.internal.scaleFactor,PDFUtils.DEFAULT_FONT_SIZE=12,PDFUtils.getTextWidth=function(t,e){return this.DUMMY_PDF.getStringUnitWidth(t)*e/this.SCALE_FACTOR},PDFUtils.getTextHeight=function(t){return t/this.SCALE_FACTOR},PDFUtils.getXCoordinateText=function(t){var e=t%8,i=5*Math.floor(t/8);return e>4&&(i+=5),i=i<50?"S"+i:50==i?"50":"N"+(100-i),e>4?(e=8-e,(e=Math.round(10*e)/10)+"S "+i):0==e?i:(e=Math.round(10*e)/10)+"N "+i},PDFUtils.getYCoordinateText=function(t){function e(t){return Math.round(10*t)/10}return 0==t?"WS":t<=16?e(t)+" WS":t<32?e(32-t)+"W WH":32==t?"WH":t<=40?e(t-32)+"E WH":t<52?e(52-t)+"W EH":52==t?"EH":t<=68?e(t-52)+"E EH":t<84?e(84-t)+" ES":"ES"},function(t){"use strict";t.drawDot=function(t,e,i,n){return this.setLineWidth(.1),-1!=t.indexOf("open")?(this.setFillColor(255),this.circle(e,i,n,"FD")):(this.setFillColor(0),this.circle(e,i,n,"FD")),n+=.1,-1==t.indexOf("backslash")&&-1==t.indexOf("x")||this.line(e-n,i-n,e+n,i+n),-1==t.indexOf("forwardslash")&&-1==t.indexOf("x")||this.line(e-n,i+n,e+n,i-n),this.setLineWidth(.3),this.setFillColor(0),this},t.resetFormat=function(){return this.setFontSize(PDFUtils.DEFAULT_FONT_SIZE),this.setFontStyle("normal"),this.setTextColor(0),this.setDrawColor(0),this.setFillColor(255),this.setLineWidth(.3),this},t.hLine=function(t,e,i){this.line(t,e,t+i,e)},t.vLine=function(t,e,i){this.line(t,e,t,e+i)}}(jsPDF.API),t.exports=PDFUtils},function(t,e,i){var n=i(4),s=function(t){this.pdf=t};s.prototype.draw=function(t,e,i,n,s){console.log("draw called")},s.prototype._drawBox=function(t,e,i,s,o,r){var a,h,d,p,u=n.getTextHeight(n.DEFAULT_FONT_SIZE),l=n.getTextWidth("S",n.DEFAULT_FONT_SIZE);o?(a="W",h="E",d="S",p="N"):(a="E",h="W",d="N",p="S"),this.pdf.setFontSize(n.DEFAULT_FONT_SIZE),r||(this.pdf.text(a,t+i/2-l/2-.5,e-2),this.pdf.text(h,t+i/2-l/2-.5,e+s+u)),this.pdf.text(d,t-l-1,e+s/2+u/2),this.pdf.text(p,t+i+1,e+s/2+u/2),this.pdf.rect(t,e,i,s),this.pdf.resetFormat()},s.prototype._drawYardlines=function(t,e,i){var s=12*t.height/47.1;this.pdf.setFontSize(s);var o,r,a,h=e.west<52&&e.east>52,d=e.west<32&&e.east>32;e.westUp?(o=t.y+(52-e.west)*i,r=t.y+(32-e.west)*i,a=5*Math.ceil(e.south/8),e.left=e.south):(o=t.y+(e.east-52)*i,r=t.y+(e.east-32)*i,a=5*Math.floor(e.north/8),e.left=e.north);for(var p=e.westUp?e.west:e.east,u=e.westUp?Math.ceil(p/4):Math.floor(p/4),l=e.westUp?-1:1,f=Math.abs(4*u-p),c=i*Math.max(0,e.north-160),g=i*Math.min(0,e.south),_=e.westUp?g:c,v=e.westUp?c:g;i*f<t.height;f+=4){var y=p-l*f;y<0||y>84||(y%84==0?this.pdf.setDrawColor(0):this.pdf.setDrawColor(200),this.pdf.hLine(t.x,t.y+f*i+_,t.width+l*(v-_)))}var x=Math.abs(8*a/5-e.left)*i,m=!1;x>4*i&&(x-=4*i,m=!0);var w=this,S=i*Math.max(0,e.east-84),T=i*Math.min(0,e.west),b=e.westUp?T:S,M=e.westUp?S:T,D=(l=e.westUp?-1:1,function(e){w.pdf.vLine(e,t.y+b,t.height+l*(M-b))});for(this.pdf.setTextColor(150);x<t.width;x+=4*i,m=!m){var F=t.x+x;if(m)this.pdf.setDrawColor(200),D(F);else{this.pdf.setDrawColor(0),D(F),d&&this.pdf.hLine(F-1.5,r,3),h&&this.pdf.hLine(F-1.5,o,3);var P="";1===(P=a<50?String(a):String(100-a)).length&&(P="0"+P);var A=n.getTextWidth(P,s)/2;if(x>A&&this.pdf.text(P[0],F-A-.5,t.y+t.height-2),x<t.width-A&&this.pdf.text(P[1],F+.5,t.y+t.height-2),(a+=e.westUp?5:-5)<0||a>100)break}}this.pdf.resetFormat()},t.exports=s},function(t,e){MathUtils={},MathUtils.PI_OVER_TWO=Math.PI/2,MathUtils.TWO_PI=2*Math.PI,MathUtils.DEGREES_TO_RADIANS_CONV_FACTOR=Math.PI/180,MathUtils.RADIANS_TO_DEGREES_CONV_FACTOR=1/MathUtils.DEGREES_TO_RADIANS_CONV_FACTOR,MathUtils.calcSquaredDistance=function(t,e,i,n){var s=i-t,o=n-e;return s*s+o*o},MathUtils.calcDistance=function(t,e,i,n){return Math.sqrt(this.calcSquaredDistance(t,e,i,n))},MathUtils.calcAngle=function(t,e){var i=Math.atan(-t/e);return e<0&&(i+=Math.PI),i},MathUtils.calcAngleAbout=function(t,e,i,n){return this.calcAngle(t-i,e-n)},MathUtils.calcRotatedXPos=function(t){return-Math.sin(t)},MathUtils.calcRotatedYPos=function(t){return Math.cos(t)},MathUtils.quarterTurn=function(t,e){return t+(2*e-1)*this.PI_OVER_TWO},MathUtils.wrapAngleDegrees=function(t){for(;t>=360;)t-=360;for(;t<0;)t+=360;return t},MathUtils.wrapAngleRadians=function(t){for(;t>=TWO_PI;)t-=this.TWO_PI;for(;t<0;)t+=this.TWO_PI;return t},MathUtils.toRadians=function(t){return t*this.DEGREES_TO_RADIANS_CONV_FACTOR},MathUtils.toDegrees=function(t){return t*this.RADIANS_TO_DEGREES_CONV_FACTOR},t.exports=MathUtils},function(t,e,i){var n=i(8),s=(i(3),function(){this._loaders=[]});s.prototype.registerLoader=function(t,e){var i=n.binarySearchForClosestLarger(this._loaders,t,s._versionLocator),o={version:t,loader:e};this._loaders.splice(i,0,o)},s.prototype.getAppropriateLoader=function(t){var e=n.binarySearchForClosestSmaller(this._loaders,t,s._versionLocator);return this._loaders[e].loader},s._versionLocator=function(t,e){return t.compareTo(e.version)},(s.FileLoader=function(){}).prototype.loadFile=function(t){console.log("FileLoader.loadFile(...) called")},t.exports=s},function(t,e){var i={binarySearchBase:function(t,e){for(var i,n,s,o,r=t.length,a=0;r>0&&0!==(n=e(t[s=a+(i=Math.floor(r/2))],s));)n>0?(a+=o=i+1,r-=o):r=i},binarySearchForClosestLarger:function(t,e,n){var s;return i.binarySearchBase(t,function(t,i){var o=n(e,t);return o<=0&&(s=i),o}),s},binarySearchForClosestSmaller:function(t,e,n){var s;return i.binarySearchBase(t,function(t,i){var o=n(e,t);return o>=0&&(s=i),o}),s},binarySearch:function(t,e,n){var s;return i.binarySearchBase(t,function(t,i){var o=n(e,t);return 0===o&&(s=i),o}),s},mergeSortedArrays:function(t,e,i){for(var n=0,s=0,o=[];n<t.length&&s<e.length;)i(t[n],e[s])<0?(o.push(t[n]),n++):(o.push(e[s]),s++);for(;n<t.length;n++)o.push(t[n]);for(;s<e.length;s++)o.push(e[s]);return o}};t.exports=i},function(t,e){t.exports=function(t){this.message=t,this.name="InvalidFileTypeError"}},function(t,e,i){var n=i(11),s=i(3),o={fromJSONString:function(t){var e=JSON.parse(t);return this.fromJSON(e)},fromJSON:function(t){var e=s.parse(t.meta.version);return n.getInstance().getAppropriateLoader(e).loadFile(t)}};t.exports=o},function(t,e,i){var n=i(7),s=i(9),o=i(0),r=i(3),a=i(12),h=i(13),d=i(14),p=i(15),u=i(17),l=i(18),f=i(19),c=i(20),g=i(21),_=function(){n.apply(this,[])};o.extends(_,n),_._instance=void 0,_.getInstance=function(){return void 0===_._instance&&(_._instance=new _,_._setupInstance(_._instance)),_._instance},_._setupInstance=function(t){t.registerLoader(new r(1,0,0),new v)},_.ViewerFileLoader=function(){},o.extends(_.ViewerFileLoader,n.FileLoader);var v=function(){};o.extends(v,_.ViewerFileLoader),v.prototype.loadFile=function(t){return this.loadShow(t.show)},v.prototype.loadShow=function(t){if(void 0===t)throw new s("Please upload a proper viewer file.");var e=new d(t.title,t.year,t.description,t.labels);return this.loadSheets(e,t.sheets),e},v.prototype.loadSheets=function(t,e){for(var i=0;i<e.length;i++)t.appendSheet(this.buildIndividualSheet(e[i]))},v.prototype.buildIndividualSheet=function(t){return new h(t.label,t.field_type,t.dot_types,t.dot_labels,t.continuities,t.beats,this.buildDots(t.movements),Object.keys(t.movements))},v.prototype.buildDots=function(t){var e=[];for(var i in t)e.push(new a(i,this.buildDotMovements(t[i])));return e},v.prototype.buildDotMovements=function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.buildIndividualMovement(t[i]));return e},v.prototype.buildIndividualMovement=function(t){switch(t.type){case"stand":return this.buildStandMovement(t);case"mark":return this.buildMarkMovement(t);case"move":return this.buildMoveMovement(t);case"goto":return this.buildGotoMovement(t);case"arc":return this.buildArcMovement(t);case"even":return this.buildEvenMovement(t);default:throw new TypeError("Movement type unrecognized.")}},v.prototype.buildStandMovement=function(t){return new p(t.x,t.y,t.facing,t.beats)},v.prototype.buildMarkMovement=function(t){return new u(t.x,t.y,t.facing,t.beats)},v.prototype.buildMoveMovement=function(t){return new f(t.start_x,t.start_y,t.step_size,t.direction,t.facing,t.beats,t.beats_per_step)},v.prototype.buildGotoMovement=function(t){return new c(t.from_x,t.from_y,t.to_x,t.to_y,t.facing,t.beats)},v.prototype.buildArcMovement=function(t){return new l(t.start_x,t.start_y,t.center_x,t.center_y,t.angle,t.facing_offset,t.beats,t.beats_per_step)},v.prototype.buildEvenMovement=function(t){return new g(t.x1,t.y1,t.x2,t.y2,t.facing,t.beats,t.beats_per_step)},t.exports=_},function(t,e){var i=function(t,e){this._label=t,this._movements=e};i.prototype.getLabel=function(){return this._label},i.prototype.getMovementCommands=function(){return this._movements},i.prototype.getAnimationState=function(t){for(var e=0;e<this._movements.length;e++){if(t<this._movements[e].getBeatDuration())return this._movements[e].getAnimationState(t);t-=this._movements[e].getBeatDuration()}},t.exports=i},function(t,e){var i=function(t,e,i,n,s,o,r,a){this._sheetLabel=t,this._fieldType=e,this._dotTypes=i,this._dotTypeAssignments=n,this._continuityTexts=s,this._duration=o,this._dots=r,this._dotLabels=a};i.prototype.getSheetLabel=function(){return this._sheetLabel},i.prototype.getFieldType=function(){return this._fieldType},i.prototype.getAllDotTypes=function(){return this._dotTypes},i.prototype.getDotType=function(t){return this._dotTypeAssignments[t]},i.prototype.getContinuityTexts=function(t){return this._continuityTexts[t]},i.prototype.getDots=function(){return this._dots},i.prototype.getDotByLabel=function(t){var e=this._dotLabels.indexOf(t);return-1===e?null:this._dots[e]},i.prototype.getDuration=function(){return this._duration},t.exports=i},function(t,e){var i=function(t,e,i,n,s){this._title=t,this._year=e,this._description=i,this._dotLabels=n,this._sheets=void 0===s?[]:s};i.prototype.getTitle=function(){return this._title},i.prototype.getYear=function(){return this._year},i.prototype.getDescription=function(){return this._description},i.prototype.getDotLabels=function(){return this._dotLabels},i.prototype.getSheets=function(){return this._sheets},i.prototype.getSheet=function(t){return this._sheets[t]},i.prototype.getNumSheets=function(){return this._sheets.length},i.prototype.appendSheet=function(t){this._sheets.push(t)},t.exports=i},function(t,e,i){var n=i(0),s=i(1),o=i(2),r=function(t,e,i,n){this._orientation=i,s.apply(this,[t,e,t,e,n])};n.extends(r,s),r.prototype.getAnimationState=function(t){return new o(this._startX,this._startY,this._orientation)},r.prototype.getContinuityText=function(){return"Close "+this._numBeats+this.getOrientation()},t.exports=r},function(t,e){t.exports=function(t,e){this.x=t,this.y=e}},function(t,e,i){var n=i(0),s=i(1),o=i(2),r=function(t,e,i,n){this._orientation=i,s.apply(this,[t,e,t,e,n])};n.extends(r,s),r.prototype.getAnimationState=function(t){return new o(this._startX,this._startY,this._orientation)},r.prototype.getContinuityText=function(){return 0==this._numBeats?"":"MT "+this._numBeats+" "+this.getOrientation()},t.exports=r},function(t,e,i){var n=i(0),s=i(6),o=i(1),r=i(2),a=function(t,e,i,n,r,a,h,d){this._beatsPerStep=d,this._centerX=i,this._centerY=n,this._radius=s.calcDistance(t,e,this._centerX,this._centerY),this._startAngle=s.calcAngleAbout(t,e,i,n),isNaN(this._startAngle)&&(this._startAngle=0),this._stepAngleDelta=s.toRadians(r)/Math.floor(h/this._beatsPerStep),this._movementIsCW=this._stepAngleDelta>=0,this._orientationOffset=s.toRadians(a);var p=this.getAnimationState(h);o.apply(this,[t,e,p.x,p.y,h])};n.extends(a,o),a.prototype.getAnimationState=function(t){var e=Math.floor(t/this._beatsPerStep),i=this._startAngle+this._stepAngleDelta*e,n=this._radius*s.calcRotatedXPos(i)+this._centerX,o=this._radius*s.calcRotatedYPos(i)+this._centerY,a=s.quarterTurn(i,this._movementIsCW)+this._orientationOffset;return new r(n,o,s.toDegrees(a))},a.prototype.getMiddlePoints=function(){for(var t=this._startAngle,e=this._startX,i=this._startY,n=[],o=0;o<this._numBeats/this._beatsPerStep;o++){t+=this._stepAngleDelta;var r=this._radius*s.calcRotatedXPos(t)+this._centerX,a=this._radius*s.calcRotatedYPos(t)+this._centerY;n.push([r-e,a-i]),e=r,i=a}return n},a.prototype.getContinuityText=function(){var t=this._numBeats/this._beatsPerStep;return"GT "+(this._movementIsCW?"CW":"CCW")+" "+Math.abs(Math.floor(s.toDegrees(this._numBeats*this._stepAngleDelta)))+" deg. ("+t+" steps)"},t.exports=a},function(t,e,i){var n=i(0),s=i(6),o=i(1),r=i(2),a=function(t,e,i,n,r,a,h){n=s.toRadians(n),this._deltaXPerStep=s.calcRotatedXPos(n)*i,this._deltaYPerStep=s.calcRotatedYPos(n)*i,this._orientation=r,this._beatsPerStep=h,numSteps=Math.floor(a/this._beatsPerStep),o.apply(this,[t,e,t+this._deltaXPerStep*numSteps,e+this._deltaYPerStep*numSteps,a])};n.extends(a,o),a.prototype.getAnimationState=function(t){return numSteps=Math.floor(t/this._beatsPerStep),new r(this._startX+this._deltaXPerStep*numSteps,this._startY+this._deltaYPerStep*numSteps,this._orientation)},a.prototype.getContinuityText=function(){var t=this._endX-this._startX,e=this._endY-this._startY,i=t<0?"S":"N",n=e<0?"W":"E";return 0==t?"Move "+Math.abs(e)+" "+n:"Move "+Math.abs(t)+" "+i},t.exports=a},function(t,e,i){var n=i(0),s=i(1),o=i(2),r=function(t,e,i,n,o,r){this._orientation=o,s.apply(this,[t,e,i,n,r])};n.extends(r,s),r.prototype.getAnimationState=function(t){return new o(this._endX,this._endY,this._orientation)},r.prototype.getContinuityText=function(){return"See Continuity ("+this._numBeats+" beats)"},t.exports=r},function(t,e,i){var n=i(0),s=i(1),o=i(2),r=function(t,e,i,n,o,r,a){this._orientation=o,this._beatsPerStep=a;var h=Math.floor(r/this._beatsPerStep);this._deltaXPerStep=(i-t)/h,this._deltaYPerStep=(n-e)/h,s.apply(this,[t,e,i,n,r])};n.extends(r,s),r.prototype.getAnimationState=function(t){var e=Math.floor(t/this._beatsPerStep);return new o(this._startX+this._deltaXPerStep*e,this._startY+this._deltaYPerStep*e,this._orientation)},r.prototype.getBeatsPerStep=function(){return this._beatsPerStep},r.prototype.getContinuityText=function(){var t=this._endX-this._startX,e=this._endY-this._startY,i=t<0?"S":"N",n=e<0?"W":"E",s=this._numBeats/this._beatsPerStep;if(t=Math.abs(t),e=Math.abs(e),0==t&&e==s)return"Move "+s+" "+n;if(0==e&&t==s)return"Move "+s+" "+i;if(e==t&&t==s)return"Move "+s+" "+i+n;var o="Even ";if(t%1!=0||e%1!=0)o+=0!=t?i:"",o+=0!=e?n:"";else{var r=[];0!=e&&r.push(Math.abs(e)+" "+n),0!=t&&r.push(Math.abs(t)+" "+i),o+=r.join(", ")}return"Even "===o&&(o+="0"),o+" ("+s+" steps)"},t.exports=r},,,,,,,,,,,,,,function(t,e,i){var n=i(36),s=i(10),o=i(0).getAllURLParams();o.dots=o.dots?o.dots.split(","):[];var r=["md-orientation","bev-orientation","sd-orientation","layout-order"];function a(t){$(".js-pdf-loading h1").addClass("error").text(t),$(".js-pdf-loading .progress-bar").remove()}function h(){window.location.search=$.map(o,function(t,e){return"dots"===e&&(t=t.join(",")),e+"="+t}).join("&")}function d(){$(".js-pdf-preview").remove(),a("Displaying preview timed out");var t=$("<a>").text("Download here").attr("href","#").click(function(){return window.generator.pdf.save(),!1});$("<p>").append(t).appendTo(".js-pdf-loading"),$("<p>").text("Are you on Google Chrome? Try opening the PDF outside of Chrome.").appendTo(".js-pdf-loading")}$(document).ready(function(){if(o.show){r.forEach(function(t){var e=$(".pdf-option input[name="+t+"]"),i=e.filter("[value="+o[t]+"]");void 0===o[t]||0===i.length?e.filter(":first").prop("checked",!0):i.prop("checked",!0)}),$("input").change(function(){o[$(this).attr("name")]=$(this).val(),h()}),$(".js-choose-dots").click(function(){var t=$(".dot-labels").val();if(0!==t.length){t=t.split("\n");for(var e=$(".dot-labels").data("labels"),i=0;i<t.length;i++){var n=t[i];if(-1===e.indexOf(n))return void alert("Dot "+n+" does not exist!")}o.dots=t,h()}});var t=o.dots[0]||"",e="index.html?show="+o.show+"&dot="+t;$(".back-link").attr("href",e),$.ajax({url:"https://calchart-server.herokuapp.com/viewer/"+o.show+"/",dataType:"text",xhr:function(){var t=$.ajaxSettings.xhr();return t.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total;$(".js-pdf-loading .progress-bar").css({width:50*e+"%"})}},t},success:function(t){$(".js-pdf-loading .progress-bar").css("width","50%");var e=s.fromJSONString(t);if($(".dot-labels").data("labels",e.getDotLabels()),$(".js-choose-dots").prop("disabled",!1),0!==o.dots.length){window.generator=new n(e,o.dots);try{window.generator.generate(o)}catch(t){throw a("An error occurred."),t}$("<iframe>").addClass("js-pdf-preview").attr("src",window.generator.data).appendTo("body").hide().load(function(){$(".js-pdf-loading").remove(),$(this).show(),clearTimeout(window.removeIFrame)}),window.removeIFrame=setTimeout(d,5e3)}else a("No dot selected.")},error:function(){a("Could not reach server.")}})}else a("No show selected.")})},function(t,e,i){var n=i(4),s=i(37),o=i(38),r=i(39),a=i(40),h=i(41),d=i(42),p=[{x:10,y:24},{x:117.95,y:24},{x:10,y:155.7},{x:117.95,y:155.7}],u=function(t,e){this.pdf=jsPDF("portrait","mm","letter"),this.show=t,this.dots=e,this.sheets=t.getSheets(),this.data=null,this.current=0,this.total=this.dots.length*this.sheets.length};u.prototype.generate=function(t){for(var e=Math.ceil(this.sheets.length/4)+2,i=0;i<this.dots.length;i++)0!==i&&this.pdf.addPage(),this.dot=this.dots[i],this._generate(t),e%2==1&&i<this.dots.length-1&&this.pdf.addPage();this.data=this.pdf.output("datauristring")},u.prototype._generate=function(t){this.headerWidget=new s(this.pdf,{dotLabel:this.dot,title:this.show.getTitle(),totalSheets:this.sheets.length}),this.dotContinuityWidget=new o(this.pdf),this.individualContinuityWidget=new r(this.pdf),this.movementDiagramWidget=new a(this.pdf,t["md-orientation"]),this.birdsEyeWidget=new h(this.pdf,t["bev-orientation"]),this.surroundingDotsWidget=new d(this.pdf,t["sd-orientation"]),this._addFrontSheet();for(var e=this._getMovements(),i=0;i<Math.ceil(this.sheets.length/4);i++){this.pdf.addPage();for(var n=[],u=0;u<4;u++){if((f=4*i+u)==this.sheets.length)break;n.push(this.sheets[f])}this.headerWidget.draw({pageNum:i+1,isLeftToRight:"ltr"===t["layout-order"]}),this.pdf.setDrawColor(150),this.pdf.vLine(107.95,24,279.4-24),this.pdf.hLine(0,142.2,215.9),this.pdf.setDrawColor(0);var l=[0,1,2,3];"ttb"===t["layout-order"]&&(l=[0,2,1,3]);for(u=0;u<n.length;u++){var f,c=p[l[u]].x,g=p[l[u]].y,_=(f=n[u]).getDotByLabel(this.dot);this.dotContinuityWidget.draw(c,g,87.95,(139.7-22)/6,{sheet:f,dotType:f.getDotType(this.dot)}),this.individualContinuityWidget.draw(c,g+(139.7-22)/6,43.975,(139.7-22)/3,{dot:_,duration:f.getDuration()}),this.movementDiagramWidget.draw(c+43.975+1,g+(139.7-22)/6,43.975,(139.7-22)/3,{movements:e[4*i+u]}),this.surroundingDotsWidget.draw(c,g+(139.7-22)/2+2,87.95,(139.7-22)/2-2,{sheet:f,dot:_}),this.current++;var v=this.current/this.total;$(".js-pdf-loading .progress-bar").css({width:50+50*v+"%"})}}this._addEndSheet(e)},u.prototype._getMovements=function(){var t=[],e=this.dot;return this.sheets.forEach(function(i){var n=[],s=i.getDotByLabel(e).getMovementCommands(),o=s[0].getStartPosition();s.forEach(function(t){var e=t.getEndPosition();void 0===t.getMiddlePoints?n.push({startPosition:o,deltaX:e.x-o.x,deltaY:e.y-o.y}):t.getMiddlePoints().forEach(function(t){n.push({startPosition:o,deltaX:t[0],deltaY:t[1]})}),o=e}),t.push(n)}),t},u.prototype._addFrontSheet=function(){this.pdf.vLine(107.95,10,269.4);var t=this.show.getTitle()+" - Dot "+this.dot;this.pdf.setFontSize(15),this.pdf.text(t,107.95-n.getTextWidth(t,15)/2,8);n.getTextHeight(10);for(var e=n.getTextWidth("00",20)+4,i=n.getTextHeight(20),s=107.95-e-6-10,o=84*s/160,r=0,a=10,h=0;h<this.sheets.length;h++){var d=this.sheets[h],p=d.getDotByLabel(this.dot);a+o>274.4&&(0===r?r=99.95:(this.pdf.addPage(),this.pdf.vLine(107.95,10,269.4),this.pdf.setFontSize(15),this.pdf.text(t,107.95-n.getTextWidth(t,15)/2,8),r=0),a=10),this.pdf.setFontSize(20),this.pdf.text(String(h+1),r+2+10,a+.5+i);var u={sheet:d,dot:p,minimal:!0};this.birdsEyeWidget.draw(r+e+2+10,a+.5,s,o,u),a+=o+1}},u.prototype._addEndSheet=function(t){this.pdf.addPage(),this.pdf.vLine(107.95,10,269.4);var e=this.show.getTitle()+" - Dot "+this.dot;this.pdf.setFontSize(15),this.pdf.text(e,107.95-n.getTextWidth(e,15)/2,8);for(var i=n.getTextHeight(10),s=n.getTextWidth("00",20)+4,o=n.getTextHeight(20),r=77.95-s-6-10,a=0,h=10,d=0;d<this.sheets.length;d++){var p=this.sheets[d],u=p.getDotByLabel(this.dot),l=25,f=(u.getMovementCommands().length+1)*(i+1)+1;f>l&&(l=f),h+l>274.4&&(0==a?a=99.95:(this.pdf.addPage(),this.pdf.vLine(107.95,10,269.4),this.pdf.setFontSize(15),this.pdf.text(e,107.95-n.getTextWidth(e,15)/2,8),a=0),h=10),this.pdf.setFontSize(20),this.pdf.text(String(d+1),a+2+10,h+.5+o),this.individualContinuityWidget.draw(a+s+2+10,h+.5,r,l,{dot:u,duration:this.sheets[d].getDuration()});var c={sheet:p,dot:u,minimal:!0,movements:t[d]};this.movementDiagramWidget.draw(a+s+r+2+10,h+.5,30,l,c),h+=l+1}},t.exports=u},function(t,e,i){var n=i(0),s=i(4),o=i(5),r=function(t,e){this.dotLabel="Dot "+e.dotLabel,this.title=e.title,this.totalSheets=e.totalSheets,this.totalPages=Math.ceil(this.totalSheets/4),o.apply(this,[t])};n.extends(r,o),r.prototype.draw=function(t){var e=this,i=t.pageNum,n=t.isLeftToRight,o={x:53.975,y:5,width:107.95,height:17,paddingX:3,paddingY:1,size:16},r={size:12,draw:function(t,n){e.pdf.text("Page ",t,n),t+=10.9,e.pdf.text(String(i),t,n-1),t+=s.getTextWidth(String(i),this.size),e.pdf.text("/",t,n),t+=1.2,e.pdf.text(String(e.totalPages),t,n+1)}},a={marginX:10,marginY:3,size:28,sheet:4*(i-1)+1,getTop:function(){return this.marginY+this.height},getBottom:function(){return this.getTop()+139.7},getLeft:function(){return this.marginX},getRight:function(){return 215.9-s.getTextWidth("SS "+this.sheet,this.size)-a.marginX},hasNext:function(){return++this.sheet<=e.totalSheets},draw:function(t,i){e.pdf.text("SS "+this.sheet,t,i)}};this.pdf.rect(o.x,o.y,o.width,o.height),this.pdf.setFontSize(o.size),this.pdf.text(this.title,107.95-s.getTextWidth(this.title,o.size)/2,o.y+o.paddingY+s.getTextHeight(o.size)),this.pdf.setFontSize(o.size-3),this.pdf.text(this.dotLabel,107.95-s.getTextWidth(this.dotLabel,o.size)/2,o.y+o.paddingY+2*s.getTextHeight(o.size)),this.pdf.setFontSize(r.size);var h=o.x+o.paddingX,d=o.y+o.height/2+s.getTextHeight(r.size)/2;r.draw(h,d),h=161.925-o.paddingX-s.getTextWidth("Page 0/0",r.size),r.draw(h,d),a.height=s.getTextHeight(a.size),a.width=s.getTextWidth("SS 00",a.size)+a.marginX,this.pdf.setFontSize(a.size),a.draw(a.getLeft(),a.getTop()),a.hasNext()&&(n?a.draw(a.getRight(),a.getTop()):a.draw(a.getLeft(),a.getBottom())),a.hasNext()&&(n?a.draw(a.getLeft(),a.getBottom()):a.draw(a.getRight(),a.getTop())),a.hasNext()&&a.draw(a.getRight(),a.getBottom())},t.exports=r},function(t,e,i){var n=i(0),s=i(4),o=i(5),r=function(t){o.apply(this,[t])};n.extends(r,o),r.prototype.draw=function(t,e,i,n,o){var r=2,a=1,h={x:t+r,y:e+a,size:10},d=o.dotType,p=i-2*r-6,u=n-2*a-3,l=o.sheet.getContinuityTexts(d);if(this.pdf.rect(t,e,i,n-1.5),void 0!==l){for(l=l.map(function(t){for(;s.getTextWidth(t,h.size)>p;)h.size--;return t});l.length*s.getTextHeight(h.size)>u;)h.size--;this.pdf.drawDot(d,h.x+1.5,h.y+2,1.5),h.x+=4,this.pdf.setFontSize(10),this.pdf.text(":",h.x,h.y+s.getTextHeight(10)),this.pdf.setFontSize(h.size),h.x+=2,h.y+=s.getTextHeight(h.size),this.pdf.text(l,h.x,h.y),this.pdf.resetFormat()}},t.exports=r},function(t,e,i){var n=i(0),s=i(4),o=i(5),r=function(t){o.apply(this,[t])};n.extends(r,o),r.prototype.draw=function(t,e,i,n,o){var r=this._getContinuityTexts(o.dot),a=2,h=1,d=10,p=s.getTextHeight(d),u=e+h,l=t+a,f=0,c=0;this.pdf.rect(t,e,i,n),this.pdf.setFontSize(d);for(var g=0;g<r.length;g++){var _=r[g],v=s.getTextWidth(_,d);if(v>f&&(f=v),(c+=p+.7)>n-p-h){if(!(f<i/2&&l<i/2)){this.pdf.text("...",l,u+c-p/2);break}l+=i/2,c=p+.7}this.pdf.text(_,l,u+c)}var y=o.duration+" beats total";this.pdf.text(y,t+i/2-s.getTextWidth(y,d)/2-3,e+n-h),this.pdf.resetFormat()},r.prototype._getContinuityTexts=function(t){var e=[];return t.getMovementCommands().forEach(function(t){var i=t.getContinuityText();""!==i&&e.push(i)}),e},t.exports=r},function(t,e,i){var n=i(0),s=i(4),o=i(5),r=function(t,e){this.westUp="west"==e,o.apply(this,[t])};n.extends(r,o),r.prototype.draw=function(t,e,i,n,o){var r=this,a=o.movements,h=s.getTextWidth("S",s.DEFAULT_FONT_SIZE),d=s.getTextHeight(s.DEFAULT_FONT_SIZE),p={x:t,y:o.minimal?e+d:e,width:i-2*(h+2),height:n-2*d};p.x+=i/2-p.width/2,p.y+=n/2-p.height/2,o.minimal&&(p.y-=d),this._drawBox(p.x,p.y,p.width,p.height,this.westUp,o.minimal);var u=a[0].startPosition,l={startX:u.x,startY:u.y,minX:0,minY:0,maxX:0,maxY:0,deltaX:0,deltaY:0,width:20,height:p.height/p.width*20,update:function(t,e){this.deltaX+=t,this.deltaY+=e,this.deltaX<this.minX?this.minX=this.deltaX:this.deltaX>this.maxX&&(this.maxX=this.deltaX),this.deltaY<this.minY?this.minY=this.deltaY:this.deltaY>this.maxY&&(this.maxY=this.deltaY)},getOverallX:function(){return this.maxX-this.minX},getOverallY:function(){return this.maxY-this.minY},scale:function(){var t=this.getOverallX(),e=this.getOverallY();t>this.width-4&&(this.width=t+4,this.height=p.height/p.width*this.width),e>this.height-4&&(this.height=e+4,this.width=p.width/p.height*this.height)}};a.forEach(function(t){l.update(t.deltaX,t.deltaY)}),l.scale();var f,c,g,_=p.width/l.width,v=l.startX+l.maxX-l.getOverallX()/2-l.width/2,y=l.startY+l.maxY-l.getOverallY()/2-l.height/2,x=v+l.width,m=y+l.height;this.westUp?(f=y,m,c=v,g=x,Math.ceil(c/8)):(f=m,y,c=x,g=v,Math.floor(c/8));var w={east:m,west:y,south:v,north:x,westUp:this.westUp};this._drawYardlines(p,w,_);var S=p.x+Math.abs(c-l.startX)*_,T=p.y+Math.abs(f-l.startY)*_,b=p.height/15,M=this.westUp?1:-1;this.pdf.setLineWidth(.5),this.pdf.circle(S,T,b),this._drawPosition(p,l.startY,T-p.y,Math.abs(c-l.startX)<Math.abs(c-g)/2),this.pdf.setLineWidth(.75),a.forEach(function(t){var e=M*t.deltaX*_,i=M*t.deltaY*_;r.pdf.line(S,T,S+e,T+i),S+=e,T+=i}),this.pdf.setLineWidth(.5),this.pdf.line(S-b,T-b,S+b,T+b),this.pdf.line(S+b,T-b,S-b,T+b),0!=l.deltaY&&this._drawPosition(p,l.startY+l.deltaY,T-p.y,Math.abs(c-l.startX-l.deltaX)<Math.abs(c-g)/2),this.pdf.resetFormat()},r.prototype._drawPosition=function(t,e,i,n){var o=t.y+i,r=s.getYCoordinateText(e);this.pdf.setFontSize(8),n?this.pdf.text(r,t.x+t.width-s.getTextWidth(r,8)-.5,o-.5):this.pdf.text(r,t.x+.5,o-.5),this.pdf.resetFormat()},t.exports=r},function(t,e,i){var n=i(0),s=i(4),o=i(5),r=function(t,e){this.westUp="west"===e,o.apply(this,[t])};n.extends(r,o),r.prototype.draw=function(t,e,i,n,o){var r=this,a=s.getTextWidth("S",s.DEFAULT_FONT_SIZE),h=(s.getTextHeight(s.DEFAULT_FONT_SIZE),i-2*(a+1.5)),d={x:t,y:e,width:h,height:84*h/160};d.x+=i/2-d.width/2,d.y+=n/2-d.height/2,this._drawBox(d.x,d.y,d.width,d.height,this.westUp,o.minimal);var p=o.sheet.getDots(),u=o.dot,l=d.width/160;this.pdf.setLineWidth(.2),this.pdf.setDrawColor(150),this.pdf.vLine(d.x+d.width/2,d.y,d.height);for(var f=d.width/21,c=d.y+32*l,g=d.y+52*l,_=0;_<21;_+=2){t=d.x+_*f;this.pdf.hLine(t,c,f),this.pdf.hLine(t,g,f)}this.pdf.setFillColor(210),p.forEach(function(t){if(t!==u){var e=t.getAnimationState(0);r.westUp||(e.x=160-e.x,e.y=84-e.y),r.pdf.circle(d.x+e.x*l,d.y+e.y*l,.5,"F")}});var v=u.getAnimationState(0);this.westUp||(v.x=160-v.x,v.y=84-v.y);t=v.x*l,e=v.y*l;this.pdf.setFillColor(0),this.pdf.circle(d.x+t,d.y+e,.5,"F"),this.pdf.resetFormat()},t.exports=r},function(t,e,i){var n=i(0),s=i(4),o=i(5);FONT_SIZE=7,DOT_RADIUS=1;var r=function(t,e){this.westUp="west"===e,o.apply(this,[t])};n.extends(r,o),r.prototype.draw=function(t,e,i,n,o){var r=this,a=s.getTextWidth("S",FONT_SIZE),h=s.getTextHeight(FONT_SIZE),d={x:t,y:e,width:i-2*(a+2),height:n-2*(h+2)};d.x+=i/2-d.width/2,d.y+=n/2-d.height/2,o.minimal&&(d.y-=h),this._drawBox(d.x,d.y,d.width,d.height,this.westUp,o.minimal);var p=d.x+d.width/2,u=d.y+d.height/2,l=o.sheet,f=o.dot.getAnimationState(0),c=this.westUp?1:-1,g=d.height/19.5,_=(this.westUp?f.x:f.x,{east:f.y+d.height/2/g,west:f.y-d.height/2/g,north:f.x+d.width/2/g,south:f.x-d.width/2/g,westUp:this.westUp});this._drawYardlines(d,_,g),this.pdf.setFontSize(FONT_SIZE),l.getDots().forEach(function(t){var e=t.getAnimationState(0),i=c*(e.x-f.x),n=c*(e.y-f.y);if(!(Math.abs(i)>14||Math.abs(n)>8)){var s=t.getLabel();0===i&&0===n?r.pdf.setFontStyle("bold"):r.pdf.setFontStyle("normal");var o=i*g+p,a=n*g+u;r.pdf.drawDot(l.getDotType(s),o,a,DOT_RADIUS),r.pdf.text(s,o-2*DOT_RADIUS,a-1.5*DOT_RADIUS)}}),this.pdf.resetFormat()},t.exports=r}]);